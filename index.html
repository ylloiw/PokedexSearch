<!DOCTYPE html>
<head>
<meta charset="utf-8" />

<html lang="en">
    <body>
        pokedex search
                <input id="inp" onfocusout = "search(this)" class = "top">
                <button id="Save" onclick = "saveSearchTerm()">Save</button>
            <br>
            <div id = "savedTerms"></div>
                    <div>
            <div id="results"></div>
                    </div>
        
    </body>

<style>
    .top{
        vertical-align:top;
    }
</style>
        
<script type='text/javascript' src='dexentries.js'></script>
<script>        
            
    let search = (input) => {
        console.log("searching")
        let item = input.value
        let searchterms = Array.from(document.getElementsByClassName("searchTerm")).map(a=>a.innerText)
        searchterms.push(item)
        removeAllChildNodes(document.getElementById("results"))
        Object.keys(dexentries).forEach(mon => {
            let found = false
            searchterms.forEach(item=>{
                let reg = new RegExp("[^a-z]" + item,"i");
                if (!found && dexentries[mon].match(reg) !== null){
                    addEntry(mon,dexentries[mon],item)
                    found = true
                }
            })
        })
    }

    let saveSearchTerm = () => {
      let div = document.createElement("div")
      div.className = "searchTerm"
        //div.style.display = "inline-block"
      div.innerHTML =  `<b>${document.getElementById("inp").value}</b>`
        document.getElementById("savedTerms").appendChild(div)
        search(document.getElementById("inp").value)
    }
    
    let addEntry = (title,entry,keyword) => {
        let div = document.createElement("div")
        div.innerHTML =  `<b>${title}</b><br>${entry}<br>`
        div.innerHTML = div.innerHTML.replaceAll(keyword,`<b style="color:red">${keyword}</b>`)
        document.getElementById("results").appendChild(div)
        }
    
    
    let removeAllChildNodes = (parent) => {
        while (parent.firstChild) {
            parent.removeChild(parent.firstChild);
        }
    }
    </script>
</html>
